#### 删除shell脚本后的^m

/bin/bash^M: 坏的解释器: 没有那个文件或目录

```
sed -i 's/\r$//' xxx.sh
```



#### 确认命令执行完毕

```
grep -aiw 
```



#### **sed 命令**

详细用法：

https://blog.csdn.net/wdz306ling/article/details/80087889

shell 脚本**替换**文件中某个字符串

1、将当前目录下包含jack串的文件中，jack字符串替换为tom

sed -i "s/jack/tom/g" `grep "jack" -rl ./`

2、将某个文件中的jack字符串替换为tom

sed -i "s/jack/tom/g" test.txt

在文件（test.txt）的指定字符串（string1）后**插入**某个字符串（string2）

格式：**sed -i 's/string1/&string2/' test.txt** sed -i 's/name:wangqian/&,11/' test.txt

------

#### **awk**

http://www.zsythink.net/archives/1336

格式化输出

```
# 将第一列的值为 `BOOTSTRAP_TOKEN` 的 第二列 打印出来
awk -F: '($1=="BOOTSTRAP_TOKEN"){ print $2 }' ./test.txt
```
```
将命令返回值打印并判断
 #! /bin/bashcheck_result=`python -V 2>&1`
 echo "check result: ${check_result}"
 if [[ ${check_result} =~ "ython" ]]
 then
 echo "python version is ${check_result}"
 else
 echo "need install python"
 fi
```

##### 输出前加上序号

```
echo "test xxxxx
xxxxx
xxxxx
test yyyyy
yyyyy
yyyyy
test zzzzz
zzzzz
zzzzz" | awk 'BEGIN{n=0;}
/^test/ { n=n+1; printf("%d.%s\n",n,$0)}
! /^test/ { print $0 }
```



#### **yum 安装循环判断**

判断yum源是否有问题就是一条命令，如果失败就退出返回值2，如果没问题，就继续脚本

```
[ $(yum repolist | awk '/repolist/{print$2}' | sed 's/,//') -eq 0 ] && echo 'your yum has problem' && exit 2 

# 如果只要安装一个包直接执行：
# yum install -y 需要安装的包 &>/dev/null
# [ $? -ne 0 ] && echo 'your yum cannot install '$i && exit 3
# 如果安装多个包，就用一个循环：
for i in 需要yum安装的多个rpm包名，空格分隔
do
 rpm -qa | grep ${i%%.*} &>/dev/null 
 [ $? -eq 0 ] || yum install -y $i&>/dev/null 
 [ $? -ne 0 ] && echo 'your yum cannot install '$i && yum_right=3
done
 [ $yum_right ] && exit 3
```



### **常见报错**：

#### 1、shell脚本启动报错

1）binary operator expected

if判断时，需要双中括号 [[  ]]

2） too many arguments

将 $变量 外面加上双引号“”